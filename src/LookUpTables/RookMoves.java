package LookUpTables;

import File.AttacksLoader;

public class RookMoves {
    private static long[][] ATTACKS;

    public static void initiate() {
        ATTACKS = AttacksLoader.loadAttacks("magic/rookAttacksOutput.txt");
    }

    public static long getPossibleMoves(int square, long occupancy) {
        long relevantOccupancy = occupancy & BLOCKERS[square];
        int index = (int) ((relevantOccupancy * MAGIC_NUMBERS[square]) >>> SHIFTS[square]);
        return ATTACKS[square][index];
    }

    private static final long[] BLOCKERS = {
            // Rank 1 (a1-h1)
            0x000101010101017EL, // a1 (0)
            0x000202020202027CL, // b1 (1)
            0x000404040404047AL, // c1 (2)
            0x0008080808080876L, // d1 (3)
            0x001010101010106EL, // e1 (4)
            0x002020202020205EL, // f1 (5)
            0x004040404040403EL, // g1 (6)
            0x008080808080807EL, // h1 (7)

            // Rank 2 (a2-h2)
            0x0001010101017E00L, // a2 (8)
            0x0002020202027C00L, // b2 (9)
            0x0004040404047A00L, // c2 (10)
            0x0008080808087600L, // d2 (11)
            0x0010101010106E00L, // e2 (12)
            0x0020202020205E00L, // f2 (13)
            0x0040404040403E00L, // g2 (14)
            0x0080808080807E00L, // h2 (15)

            // Rank 3 (a3-h3)
            0x00010101017E0100L, // a3 (16)
            0x00020202027C0200L, // b3 (17)
            0x00040404047A0400L, // c3 (18)
            0x0008080808760800L, // d3 (19)
            0x00101010106E1000L, // e3 (20)
            0x00202020205E2000L, // f3 (21)
            0x00404040403E4000L, // g3 (22)
            0x00808080807E8000L, // h3 (23)

            // Rank 4 (a4-h4)
            0x000101017E010100L, // a4 (24)
            0x000202027C020200L, // b4 (25)
            0x000404047A040400L, // c4 (26)
            0x0008080876080800L, // d4 (27)
            0x001010106E101000L, // e4 (28)
            0x002020205E202000L, // f4 (29)
            0x004040403E404000L, // g4 (30)
            0x008080807E808000L, // h4 (31)

            // Rank 5 (a5-h5)
            0x0001017E01010100L, // a5 (32)
            0x0002027C02020200L, // b5 (33)
            0x0004047A04040400L, // c5 (34)
            0x0008087608080800L, // d5 (35)
            0x0010106E10101000L, // e5 (36)
            0x0020205E20202000L, // f5 (37)
            0x0040403E40404000L, // g5 (38)
            0x0080807E80808000L, // h5 (39)

            // Rank 6 (a6-h6)
            0x00017E0101010100L, // a6 (40)
            0x00027C0202020200L, // b6 (41)
            0x00047A0404040400L, // c6 (42)
            0x0008760808080800L, // d6 (43)
            0x00106E1010101000L, // e6 (44)
            0x00205E2020202000L, // f6 (45)
            0x00403E4040404000L, // g6 (46)
            0x00807E8080808000L, // h6 (47)

            // Rank 7 (a7-h7)
            0x007E010101010100L, // a7 (48)
            0x007C020202020200L, // b7 (49)
            0x007A040404040400L, // c7 (50)
            0x0076080808080800L, // d7 (51)
            0x006E101010101000L, // e7 (52)
            0x005E202020202000L, // f7 (53)
            0x003E404040404000L, // g7 (54)
            0x007E808080808000L, // h7 (55)

            // Rank 8 (a8-h8)
            0x7E01010101010100L, // a8 (56)
            0x7C02020202020200L, // b8 (57)
            0x7A04040404040400L, // c8 (58)
            0x7608080808080800L, // d8 (59)
            0x6E10101010101000L, // e8 (60)
            0x5E20202020202000L, // f8 (61)
            0x3E40404040404000L, // g8 (62)
            0x7E80808080808000L  // h8 (63)
    };

    private static final long[] MAGIC_NUMBERS = {
            // Rank 1 (a1-h1)
            0x8080041061804000L, // a1 (0)
            0x8200102082450200L, // b1 (1)
            0x1080100008200081L, // c1 (2)
            0x4080048208001000L, // d1 (3)
            0x8A80040003080080L, // e1 (4)
            0x4100020804000100L, // f1 (5)
            0x2080008002000100L, // g1 (6)
            0x0200014C00248201L, // h1 (7)

            // Rank 2 (a2-h2)
            0x0048800080400020L, // a2 (8)
            0x0400400050002000L, // b2 (9)
            0x0000808020001000L, // c2 (10)
            0x0001801800300080L, // d2 (11)
            0x0041000500880110L, // e2 (12)
            0x8428808004008200L, // f2 (13)
            0x4004001044020108L, // g2 (14)
            0x1002000080750204L, // h2 (15)

            // Rank 3 (a3-h3)
            0x0C24208004401081L, // a3 (16)
            0x0000404010002008L, // b3 (17)
            0x1440420010802200L, // c3 (18)
            0x9000808008001000L, // d3 (19)
            0x0100050011000800L, // e3 (20)
            0x0400808004000200L, // f3 (21)
            0x0114040010010882L, // g3 (22)
            0x0240020000408401L, // h3 (23)

            // Rank 4 (a4-h4)
            0x0C00800080204000L, // a4 (24)
            0x2000200080400080L, // b4 (25)
            0x0000420200201080L, // c4 (26)
            0x8200100080080080L, // d4 (27)
            0x1000040080800800L, // e4 (28)
            0x0024000480220080L, // f4 (29)
            0x0081000100040200L, // g4 (30)
            0x00000042000400A1L, // h4 (31)

            // Rank 5 (a5-h5)
            0x0080002000C00048L, // a5 (32)
            0x03C0081000200020L, // b5 (33)
            0x0410040800200020L, // c5 (34)
            0x4020080080801000L, // d5 (35)
            0xE06400A481800801L, // e5 (36)
            0x4400800200800400L, // f5 (37)
            0x0118800100800200L, // g5 (38)
            0x2020004102000084L, // h5 (39)

            // Rank 6 (a6-h6)
            0x0000982040008000L, // a6 (40)
            0x0210004820074002L, // b6 (41)
            0x4101002000410010L, // c6 (42)
            0x8181001000090020L, // d6 (43)
            0x0500480100110044L, // e6 (44)
            0x0050020004008080L, // f6 (45)
            0x8749000600030004L, // g6 (46)
            0x20000C0840820031L, // h6 (47)

            // Rank 7 (a7-h7)
            0xA0C0800020400880L, // a7 (48)
            0x9040100020084440L, // b7 (49)
            0x8001002004401100L, // c7 (50)
            0x0020100008008080L, // d7 (51)
            0xD000080004008080L, // e7 (52)
            0x4400200440100801L, // f7 (53)
            0x0841000200040100L, // g7 (54)
            0x8C4D20940D045200L, // h7 (55)

            // Rank 8 (a8-h8)
            0x0089002412408001L, // a8 (56)
            0x810128C001005281L, // b8 (57)
            0x040840820010200AL, // c8 (58)
            0x8081022018047001L, // d8 (59)
            0x0202002004100802L, // e8 (60)
            0x3009000268240031L, // f8 (61)
            0x000001020800B004L, // g8 (62)
            0x0602002100940042L  // h8 (63)
    };
    private static final int[] SHIFTS = {
            // Rank 1
            52, 53, 53, 53, 53, 53, 53, 52,  // a1-h1
            // Rank 2
            53, 54, 54, 54, 54, 54, 54, 53,  // a2-h2
            // Rank 3
            53, 54, 54, 54, 54, 54, 54, 53,  // a3-h3
            // Rank 4
            53, 54, 54, 54, 54, 54, 54, 53,  // a4-h4
            // Rank 5
            53, 54, 54, 54, 54, 54, 54, 53,  // a5-h5
            // Rank 6
            53, 54, 54, 54, 54, 54, 54, 53,  // a6-h6
            // Rank 7
            53, 54, 54, 54, 54, 54, 54, 53,  // a7-h7
            // Rank 8
            52, 53, 53, 53, 53, 53, 53, 52   // a8-h8
    };
}